## 의존성 주입(Dependency Injection) ❓️

생성자나 메서드 등을 통해 외부로부터 생성된 객체를 전달받는 것을 말합니다.

### 특징
- 클래스간 결합도를 느슨하게 합니다.
- 인터페이스 기반으로 설계되며, 코드를 유연하게 합니다.
- Stub 또는 Mock 객체를 사용해 단위테스트에 용이합니다.
   - mock이란?
       실제 객체를 만들어 사용하기에 시간/비용 등의 Cost가 높거나 객체 서로간의 의존성이 강해 구현하기 힘들 경우 더미 객체를 만들어 사용하는 방법입니다.
   - stub이란?
   더미 객체 보다 좀더 구현된 객체로 더미 객체가 마치 실제로 동작하는 것처럼 보이게 만들어 놓은 객체입니다.
   특정 상태를 가정해서 하드코딩된 형태이기 때문에 로직에 따른 값의 변경은 테스트 할 수 없습니다.
(출처: https://www.crocus.co.kr/1555)

➡ 결과적으로 코드 재사용, 리팩터링, 테스트가 편해집니다.

### 간단한 예시
```kotlin
// 의존성 주입이 없는 경우
class TodoRepository {
    private val db = SQLiteDatabase()
    
    fun load(id: String) { ... }
}
    
fun main() {
    val repository = TodoRepository()
    repository.load("1234")
}
```
```kotlin
// 의존성을 외부로부터 주입받은 경우
class TodoRepository(private val db: Database) {
    fun load(id: String) { ... }
}
    
fun main() {
    val db = SQLiteDatabase() // 외부에서 생성
    val repository = TodoRepository(db) // 매개변수로 전달
    repository.load("1234")
}
```

## DI framework에는 뭐가 있을까❓️
대표적으로
- Dagger 2
- Koin
- Hilt
가 있으며 각각의 특징과 장단점이 있어 프로젝트마다 알맞게 선택해 사용하는 것을 추천합니다.

### Dagger2
#### 장점
- 강력하고 빠른 의존성 주입 프레임워크로 많은 개발자들이 애용하고 있습니다.
- 컴파일 타임에 DI 코드들을 생성해 런타임 성능이 좋습니다.
- [리플렉션](https://velog.io/@yuuuzzzin/Kotlin-%EB%A6%AC%ED%94%8C%EB%A0%89%EC%85%98Reflection)을 사용 X
- 자원 공유의 단순화가 가능합니다.
- 라이브러리 크기가 작습니다.
#### 단점
- 러닝 커브가 높고 프로젝트 설정이 까다롭습니다.
- 간단한 프로그램을 만들 때에는 배보다 배꼽이 더 클만큼 번거롭습니다.
- 컴파일 시간이 오래걸립니다.

### Koin
#### 장점
- 러닝커브가 낮아 쉽고 빠르게 적용이 가능합니다.
- Kotlin 개발 환경에 도입하기 쉽습니다.
- 별도의 어노테이션을 사용하지 않기 때문에 컴파일 시간이 단축됩니다.
- ViewModel 주입을 쉽게 할 수 있는 별도의 라이브러리를 제공합니다.
#### 단점
- 런타임시 컴포넌트가 생성되어 있지 않다면 크래시가 발생합니다.
- 런타임에 DI 코드를 생성해 런타임 성능이 좋지 않습니다.
- 리플렉션을 이용해 성능상 좋지 않습니다.
- koin.get() 함수와 같이 모듈간 의존성에 대해 신경을 쓰지 않고 인스턴스를 사용하는 경우, 추후 멀티모듈로 전향 시 어려움을 겪을 수 있습니다.
- 모든 클래스가 서비스 로케이터에 종속됩니다.
- 의존 관계 파악이 어렵습니다.

### Hilt
#### 장점
- Dagger2 기반의 라이브러리이며 훨씬 사용하기 쉽고 표준화된 사용법을 제시합니다.
- 프로젝트 설정이 간소화됨.
- 쉬운 모듈 탐색과 통합
- 보일러플레이트 코드 감소
- Android Studio의 지원
- AndroidX 라이브러리의 호환
   
#### 단점
- Hilt가 지원하는 안드로이드 클래스 외의 곳에서 사용하려면 부가적인 사용구를 추가해줘야한다

### Dagger2 & Koin & Hilt 비교
||Dagger2|Koin|Hilt|
|:---:|:---:|:---:|:---:|
|적용 가능 언어|Java, Kotlin|Kotlin|Java, Kotlin|
|러닝 커브|높음|낮음|낮음|
|DI&에러 검출 시점|Compie Time|RunTime|Compile Time|

## 공부하며 느낀 생각.. 
안드로이드 프로젝트를 진행하면서 `Hilt`를 사용해 의존성 주입을 했었습니다. 프로젝트 설정이 아주 간단했고 가독성과 코드 이해도가 아주 높았습니다. `Hilt`는 `드로이드나이츠 2020`에서 옥수환 개발자님이 말씀하신 DI 프레임워크의 궁극적인 목표 3가지인
- 정확한 사용 방법
- 쉬운 설정 방법
- 중요한 것들에 집중할 수 있도록 하기

를 만족하는 프레임워크라는 생각이 들었습니다. Hilt의 사용법을 더욱 정확하게 공부하고 프로젝트에 다시 적용해보아야겠다는 생각이 들었습니다. 테스트를 용이하게 하는 DI인 만큼 테스트에 관한 부분도 공부해서 적용해보아야겠습니다.

> 참고
> [Android 개발자 문서 - Android의 종속 항목 삽입](https://developer.android.com/training/dependency-injection)
> [[드로이드나이츠 2020] 옥수환 - Hilt와 함께 하는 안드로이드 의존성 주입](https://youtu.be/gkUCs6YWzEY)
> [[드로이드나이츠 2021] 이기정 - 안드로이드 앱에서 Koin걷어내고 Hilt로 마이그레이션하기](https://youtu.be/G2gaUnFGGV0)
